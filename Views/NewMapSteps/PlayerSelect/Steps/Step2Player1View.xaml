<UserControl x:Class="WWXMapEditor.Views.NewMapSteps.PlayerSelect.Step2Player1View"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/w3.org/2001/XMLSchema"
             xmlns:conv="clr-namespace:WWXMapEditor.Converters"
             x:Name="Root">
    <UserControl.Resources>
        <conv:CountryAvailabilityConverter x:Key="CountryAvailabilityConverter"/>
        <conv:CountryClaimedByConverter x:Key="CountryClaimedByConverter"/>
    </UserControl.Resources>

    <Border Style="{DynamicResource CardBorderStyle}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0" Text="Player 1" Style="{DynamicResource PlayerHeader}"/>

            <!-- Two rows of country tiles -->
            <ListBox Grid.Column="1"
                     ItemsSource="{DynamicResource CountryOptions}"
                     SelectedItem="{Binding ParentViewModel.Player1Country, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                     ScrollViewer.VerticalScrollBarVisibility="Disabled"
                     BorderThickness="0"
                     Background="{x:Null}">
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Rows="2" Columns="4"/>
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBox.ItemContainerStyle>
                    <Style BasedOn="{DynamicResource CountryTileContainerBaseStyle}" TargetType="ListBoxItem">
                        <Setter Property="IsEnabled">
                            <Setter.Value>
                                <MultiBinding Converter="{StaticResource CountryAvailabilityConverter}">
                                    <Binding />
                                    <Binding Path="ParentViewModel.Player1Country"/>
                                    <Binding Path="ParentViewModel.Player2Country"/>
                                    <Binding Path="ParentViewModel.Player3Country"/>
                                    <Binding Path="ParentViewModel.Player4Country"/>
                                </MultiBinding>
                            </Setter.Value>
                        </Setter>
                        <Setter Property="ToolTip">
                            <Setter.Value>
                                <MultiBinding Converter="{StaticResource CountryClaimedByConverter}">
                                    <Binding />
                                    <Binding Path="ParentViewModel.Player1Country"/>
                                    <Binding Path="ParentViewModel.Player2Country"/>
                                    <Binding Path="ParentViewModel.Player3Country"/>
                                    <Binding Path="ParentViewModel.Player4Country"/>
                                </MultiBinding>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListBox.ItemContainerStyle>
            </ListBox>

            <!-- Live swatch -->
            <Border Grid.Column="2" Width="24" Height="24" CornerRadius="3" BorderThickness="1" BorderBrush="{DynamicResource BorderBrush}" Margin="10,0,0,0" VerticalAlignment="Top">
                <Border.Style>
                    <Style TargetType="Border">
                        <Setter Property="Background" Value="{x:Null}"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ParentViewModel.Player1Country}" Value="Redonia">
                                <Setter Property="Background" Value="{DynamicResource CountryRedoniaBrush}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding ParentViewModel.Player1Country}" Value="Sevaria">
                                <Setter Property="Background" Value="{DynamicResource CountrySevariaBrush}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding ParentViewModel.Player1Country}" Value="Auria">
                                <Setter Property="Background" Value="{DynamicResource CountryAuriaBrush}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding ParentViewModel.Player1Country}" Value="Maritain">
                                <Setter Property="Background" Value="{DynamicResource CountryMaritainBrush}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding ParentViewModel.Player1Country}" Value="Norvos">
                                <Setter Property="Background" Value="{DynamicResource CountryNorvosBrush}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding ParentViewModel.Player1Country}" Value="Valtro">
                                <Setter Property="Background" Value="{DynamicResource CountryValtroBrush}"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
            </Border>
        </Grid>
    </Border>
</UserControl>
<UserControl x:Class="WWXMapEditor.Views.NewMapSteps.PlayerSelect.PlayerSelectWizardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ps="clr-namespace:WWXMapEditor.Views.NewMapSteps.PlayerSelect">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!-- Shared resources (styles, brushes, constants, etc.) -->
                <ResourceDictionary Source="PlayerSelectSharedResources.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <!-- Per-step DataTemplates -->
            <DataTemplate x:Key="Step1Template">
                <ps:Step1PlayerCountView/>
            </DataTemplate>

            <DataTemplate x:Key="Step2Template">
                <ps:Step2Player1View/>
            </DataTemplate>

            <DataTemplate x:Key="Step3Template">
                <ps:Step3Player2View/>
            </DataTemplate>

            <DataTemplate x:Key="Step4Template">
                <ps:Step4Player3View/>
            </DataTemplate>

            <DataTemplate x:Key="Step5Template">
                <ps:Step5Player4View/>
            </DataTemplate>

            <DataTemplate x:Key="Step6Template">
                <ps:Step6ConfirmView/>
            </DataTemplate>
        </ResourceDictionary>
    </UserControl.Resources>

    <!-- Card container for the inner wizard -->
    <Border Style="{DynamicResource CardBorderStyle}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <StackPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Top" Margin="0,0,0,12">
                <TextBlock Text="PLAYER SELECTION" Style="{DynamicResource SectionKicker}" Margin="0,0,12,0"/>
                <TextBlock Text="{Binding StepIndex, StringFormat=Step {0} of 6}"
                           Foreground="{DynamicResource ForegroundSecondaryBrush}"
                           FontFamily="Consolas"
                           VerticalAlignment="Center"/>
            </StackPanel>

            <!-- Step content host: ContentPresenter with triggers on StepIndex -->
            <ContentPresenter x:Name="StepHost"
                              Grid.Row="1"
                              Content="{Binding}">
                <ContentPresenter.Style>
                    <Style TargetType="ContentPresenter">
                        <Setter Property="ContentTemplate" Value="{StaticResource Step1Template}"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding StepIndex}" Value="1">
                                <Setter Property="ContentTemplate" Value="{StaticResource Step1Template}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding StepIndex}" Value="2">
                                <Setter Property="ContentTemplate" Value="{StaticResource Step2Template}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding StepIndex}" Value="3">
                                <Setter Property="ContentTemplate" Value="{StaticResource Step3Template}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding StepIndex}" Value="4">
                                <Setter Property="ContentTemplate" Value="{StaticResource Step4Template}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding StepIndex}" Value="5">
                                <Setter Property="ContentTemplate" Value="{StaticResource Step5Template}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding StepIndex}" Value="6">
                                <Setter Property="ContentTemplate" Value="{StaticResource Step6Template}"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ContentPresenter.Style>
            </ContentPresenter>

            <!-- Inner wizard nav -->
            <Grid Grid.Row="2" Margin="0,16,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Button x:Name="BtnBack"
                        Grid.Column="0"
                        Content="← Back"
                        MinWidth="80"
                        Margin="0,0,8,0"
                        Click="BtnBack_Click"/>

                <TextBlock Grid.Column="1"
                           Text="{Binding ValidationMessage}"
                           Foreground="{DynamicResource AccentBrush}"
                           VerticalAlignment="Center"
                           TextWrapping="Wrap"
                           FontFamily="Consolas"
                           Opacity="0.9"/>

                <Button x:Name="BtnNext"
                        Grid.Column="2"
                        Content="Next →"
                        MinWidth="92"
                        Click="BtnNext_Click"/>
            </Grid>
        </Grid>
    </Border>
</UserControl>